import{defineCustomElements as L}from"https://cdn.jsdelivr.net/npm/@dytesdk/ui-kit@1.51.1/loader/index.es2017.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const a of t.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function o(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?t.credentials="include":e.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function s(e){if(e.ep)return;e.ep=!0;const t=o(e);fetch(e.href,t)}})();L();const T="<svg fill='currentColor' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'><path d='M9.5 2a7.503 7.503 0 0 1 7.179 5.321 7.5 7.5 0 1 1-9.357 9.358A7.5 7.5 0 0 1 9.5 2Zm7.498 7.599L17 9.5A7.5 7.5 0 0 1 9.6 17a5.5 5.5 0 1 0 7.399-7.4ZM9.5 4a5.5 5.5 0 0 0-2.498 10.401L7 14.5A7.5 7.5 0 0 1 14.4 7a5.497 5.497 0 0 0-4.9-3Z' fill='currentColor'/></svg>",O="<svg fill='currentColor' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'><path d='M6 16.938v2.121L5.059 20h-2.12L6 16.938Zm16.002-2.503v2.122L18.56 20h-.566v-1.557l4.008-4.008ZM8.75 14h6.495a1.75 1.75 0 0 1 1.744 1.607l.006.143V20H7v-4.25a1.75 1.75 0 0 1 1.606-1.744L8.75 14Zm-.729-3.584c.06.579.243 1.12.523 1.6L2 18.56v-2.122l6.021-6.022Zm13.98-.484v2.123l-4.007 4.01v-.315l-.004-.168a2.734 2.734 0 0 0-.387-1.247l4.399-4.403ZM12.058 4 2 14.06v-2.121L9.936 4h2.12Zm9.945 1.432v2.123l-5.667 5.67a2.731 2.731 0 0 0-.86-.216l-.23-.009h-.6a4.02 4.02 0 0 0 .855-1.062l6.502-6.506ZM12 7a3 3 0 1 1 0 6 3 3 0 0 1 0-6ZM7.559 4l-5.56 5.56V7.438L5.439 4h2.12Zm13.498 0-5.148 5.149a3.98 3.98 0 0 0-.652-1.47L18.935 4h2.122Zm-4.498 0-2.544 2.544a3.974 3.974 0 0 0-1.6-.522L14.438 4h2.122Z' fill='currentColor'/></svg>",v={switchFilter:T,addFilter:O},D=async()=>{const{VITE_API_BASE:i,VITE_MEETING_ID:n,VITE_AUTH_HEADER:o,VITE_DEEP_AR_TOKEN:s}={VITE_DEEP_AR_TOKEN:"65dbfab62ee7614ffe9a9bff3b2ffb06ede0bf8f90c6bea28f9a757ce0d17a8d0f83e81239a23b32",VITE_AUTH_HEADER:"OTNlODQyYWUtMjRkYy00NTUyLWFlNjktMWQyMzExNjU5NzA0Ojc0ODlhYWNkODc2ZjUxOGJhNjRi",VITE_MEETING_ID:"bbb9b81a-1f8f-4818-b819-d711c035fa26",VITE_API_BASE:"https://api.cluster.dyte.in",BASE_URL:"/video-calling-with-ar-filters",MODE:"production",DEV:!1,PROD:!0,SSR:!1},e=C(),t=await fetch(`${i}/v2/meetings/${n}/participants`,{method:"POST",headers:{Accept:"application/json",Authorization:`Basic ${o}`,"Content-Type":"application/json"},body:JSON.stringify({client_specific_id:e,name:e,preset_name:"group_call_host"})});if(!t.ok)return;const{data:a}=await t.json(),c=await DyteClient.init({authToken:a.token,defaults:{audio:!1,video:!1}});c.joinRoom(),M(c);const f=["./effects/lion","./effects/flowers","./effects/dalmatian","./effects/background_segmentation","./effects/background_blur","./effects/aviators"],u=document.createElement("canvas");u.width=680,u.height=480;const m=await deepar.initialize({licenseKey:s,canvas:u,effect:f[0],additionalOptions:{cameraConfig:{disableDefaultCamera:!0}}});let y=0,h=0;const l=document.getElementById("arFilter"),E=document.getElementById("switchFilter");l.icon=v.addFilter,E.icon=v.switchFilter,l.addEventListener("click",b),E.addEventListener("click",I);function b(){y++,y%2==0?(l.label="Add Filter",c.self.removeVideoMiddleware(w)):(l.label="Remove Filter",c.self.addVideoMiddleware(w))}async function w(){let r=null;const d=document.createElement("canvas");d.width=640,d.height=480;const _=d.getContext("2d");return async(g,A)=>{_.drawImage(g,0,0),r&&A.drawImage(r,0,0,r.width,r.height,0,0,g.width,g.height),await m.processImage(d);const p=new Image;p.id="picture",p.src=await m.takeScreenshot(),r=p}}async function I(){h=(h+1)%f.length,await m.switchEffect(f[h])}};D();function M(i){const n=document.getElementsByClassName("dyte");for(const o of n)o.meeting=i;document.getElementById("loader").style.display="none",document.getElementById("app").style.display="flex"}function C(){return Math.random().toString(36).substring(2,7)}document.body.addEventListener("dyteStateUpdate",({detail:i})=>{document.querySelector("dyte-sidebar").style.display=i.activeSidebar?"flex":"none",document.querySelector("dyte-sidebar").states={sidebar:i.activeSidebar?i.sidebar:"none"}});
